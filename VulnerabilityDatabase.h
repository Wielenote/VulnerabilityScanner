#ifndef VULNERABILITYDATABASE_H
#define VULNERABILITYDATABASE_H
#include <vector>
#include <map>
#include <string>
#include <JsonParser.h>
using namespace std;

class V_Database
{
public:
    V_Database();
    ~V_Database();
    void SortVulners(const string& package_name);
    void InsertVulnerability(const Vulnerability& v, const string& package_name);
    bool InsertVulnerability(vector<Vulnerability>& v, const string& package_name);
    map<string, vector<Vulnerability>> GetDatabase() const;
    map<string, Vulnerability> GetCVEtoPackage() const;
    vector<Vulnerability> vulners;
private:
    map<string, vector<Vulnerability>> data;
    map<string, Vulnerability> cve_to_vulnerability;

};

#endif // VULNERABILITYDATABASE_H
